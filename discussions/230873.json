[
  {
    "Id": "507111",
    "ThreadId": "230873",
    "Html": "<p>this is simple code : managedwifi-41381&nbsp;</p>\r\n<p><span>i add&nbsp;&nbsp;WlanReasonNotification to WifiExample , like this</span></p>\r\n<p>static string GetStringForSSID(Wlan.Dot11Ssid ssid)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Encoding.ASCII.GetString( ssid.SSID, 0, (int) ssid.SSIDLength );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static void Main( string[] args )<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WlanClient client = new WlanClient();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach ( WlanClient.WlanInterface wlanIface in client.Interfaces )<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wlanIface.WlanReasonNotification += new WlanClient.WlanInterface.WlanReasonNotificationEventHandler(wlanIface_WlanReasonNotification);</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string profileName = &quot;RDD&quot;; // this is also the SSID</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string key = &quot;4227004288&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string profileXml = string.Format(&quot;&lt;?xml version=\\&quot;1.0\\&quot;?&gt;&lt;WLANProfile xmlns=\\&quot;<a href=\"http://www.microsoft.com/networking/WLAN/profile/v1/\">{0}{0}ESSopenWEPfalsenetworkKeyfalse{1}0http://www.microsoft.com/networking/WLAN/profile/v1\\&quot;&gt;&lt;name&gt;{0}&lt;/name&gt;&lt;SSIDConfig&gt;&lt;SSID&gt;&lt;name&gt;{0}&lt;/name&gt;&lt;/SSID&gt;&lt;/SSIDConfig&gt;&lt;connectionType&gt;ESS&lt;/connectionType&gt;&lt;MSM&gt;&lt;security&gt;&lt;authEncryption&gt;&lt;authentication&gt;open&lt;/authentication&gt;&lt;encryption&gt;WEP&lt;/encryption&gt;&lt;useOneX&gt;false&lt;/useOneX&gt;&lt;/authEncryption&gt;&lt;sharedKey&gt;&lt;keyType&gt;networkKey&lt;/keyType&gt;&lt;protected&gt;false&lt;/protected&gt;&lt;keyMaterial&gt;{1}&lt;/keyMaterial&gt;&lt;/sharedKey&gt;&lt;keyIndex&gt;0&lt;/keyIndex&gt;&lt;/security&gt;&lt;/MSM&gt;&lt;/WLANProfile</a>&gt;&quot;, profileName, key);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wlanIface.SetProfile( Wlan.WlanProfileFlags.AllUser, profileXml, true );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wlanIface.Connect( Wlan.WlanConnectionMode.Profile, Wlan.Dot11BssType.Any, profileName );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.Read();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static void wlanIface_WlanReasonNotification(Wlan.WlanNotificationData notifyData, Wlan.WlanReasonCode reasonCode)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WlanClient client = new WlanClient();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; client.GetStringForReasonCode(reasonCode);</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine(client.GetStringForReasonCode(reasonCode));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>\r\n<p>when happen connection fail (ex : key mismatch...etc), program go in WlanReasonNotification event , and it will throw a exception tell me &quot;<span>Parameter error&quot; in </span></p>\r\n<p><span>&nbsp;&nbsp;public string GetStringForReasonCode(Wlan.WlanReasonCode reasonCode)<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;StringBuilder sb = new StringBuilder(1024); // the 1024 size here is arbitrary; the WlanReasonCodeToString docs fail to specify a recommended size<br>&nbsp;&nbsp;&nbsp;Wlan.ThrowIfError(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#ff0000\">Wlan.WlanReasonCodeToString(reasonCode, sb.Capacity, sb, IntPtr.Zero));</span><br>&nbsp;&nbsp;&nbsp;return sb.ToString();<br>&nbsp;&nbsp;}</span></p>\r\n<p><span>Can any one teach me&nbsp;how to use &quot;GetStringForReasonCode(reasonCode);&quot;</span></p>\r\n<p><span>thanks for your help</span></p>",
    "PostedDate": "2010-10-14T01:23:26.74-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "873161",
    "ThreadId": "230873",
    "Html": "<p>Hi,</p>\r\n<p>Even i wanted to know how to use ﻿﻿﻿﻿﻿GetStringForReasonCode and Catch any exception occured while connecting wifi.</p>\r\n<p>Wlan.WlanReasonCode reasonCode = new Wlan.WlanReasonCode();</p>\r\n<p>reasonCode = wlanIface.SetProfile(Wlan.WlanProfileFlags.AllUser, profileXml, true);</p>\r\n<p>﻿﻿﻿﻿﻿Above code ﻿reason Code will always returns Suceess even though there is exception.</p>\r\n<p>If any solution please share.</p>\r\n<p>Thanks﻿</p>",
    "PostedDate": "2012-07-18T04:31:18.893-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]