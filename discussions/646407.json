[
  {
    "Id": "1449123",
    "ThreadId": "646407",
    "Html": "I am trying to connect to WiFi network using this code. It list the WiFI details correctly But I am not sure how to connect to a WiFi using this code.  Its not able to connect to the WiFI Its showing.\r<br />\n The network connection profile is corrupted <br />\nWhen I click the connect button \r<br />\n<br />\nI have pasted my code here<br />\n\r<br />\nusing System;\r<br />\nusing System.Collections.Generic;\r<br />\nusing System.ComponentModel;\r<br />\nusing System.Data;\r<br />\nusing System.Drawing;\r<br />\nusing System.Linq;\r<br />\nusing System.Text;\r<br />\nusing System.Threading.Tasks;\r<br />\nusing System.Windows.Forms;\r<br />\nusing NativeWifi;\r<br />\nnamespace WindowsFormsApplication1\r<br />\n{<br />\n<pre><code>public partial class Form1 : Form\n{\n\n    private struct Message\n    {\n        public const string ErrorTitle = &quot;Error&quot;;\n    }\n\n    private struct SSIDParameters\n    {\n        public byte[] SSID;\n        public uint linkQuality;\n        public NativeWifi.Wlan.Dot11BssType dot11BssType;\n        public string tMac;\n        public int rssi;\n    }\n\n    List&lt;SSIDParameters&gt; m_paramList = new List&lt;SSIDParameters&gt;();\n\n    public Form1()\n    {\n        InitializeComponent();\n    }\n\n    private void btnRefresh_Click(object sender, EventArgs e)\n    {\n        SearchSSid();\n    }\n\n    private void SearchSSid()\n    {\n        WlanClient client = new WlanClient();\n\n        foreach (WlanClient.WlanInterface wlanIface in client.Interfaces)\n        {\n\n            listViewSSID.Items.Clear();\n            Wlan.WlanBssEntry[] wlanBssEntries = wlanIface.GetNetworkBssList();\n\n            foreach (Wlan.WlanBssEntry network in wlanBssEntries)\n            {\n                int rss = network.rssi;\n                //     MessageBox.Show(rss.ToString());\n                byte[] macAddr = network.dot11Bssid;\n\n                string tMac = &quot;&quot;;\n\n                for (int i = 0; i &lt; macAddr.Length; i++)\n                {\n\n                    tMac += macAddr[i].ToString(&quot;x2&quot;).PadLeft(2, '0').ToUpper();\n\n                }\n\n                SSIDParameters _params = new SSIDParameters();\n\n                Console.WriteLine(&quot;MAC: {0}.&quot;, tMac);\n\n                Console.WriteLine(&quot;RSSID:{0}&quot;, rss.ToString());\n                _params.SSID = network.dot11Ssid.SSID;\n                _params.linkQuality = network.linkQuality;\n                _params.dot11BssType = network.dot11BssType;\n                _params.tMac = tMac;\n                _params.rssi = network.rssi;\n                m_paramList.Add(_params);\n                string networkName = System.Text.ASCIIEncoding.ASCII.GetString(network.dot11Ssid.SSID).ToString();\n                ListViewItem item = new ListViewItem(networkName);\n                item.SubItems.Add(network.linkQuality + &quot;%&quot;);\n                listViewSSID.Items.Add(item);\n            }\n            Console.ReadLine();\n        }\n    }\n\n    private void btnConnect_Click(object sender, EventArgs e)\n    {       \n        string profileName = &quot;&quot;;\n        string mac = &quot;&quot;;\n        string key = txtSecurityKey.Text;\n        string selectedssid = listViewSSID.SelectedItems[0].Text;\n        foreach (SSIDParameters _parameter in m_paramList)\n        {\n            if (System.Text.ASCIIEncoding.ASCII.GetString(_parameter.SSID).ToString() == selectedssid)\n            {\n                profileName = selectedssid.Replace(&quot;\\0&quot;, &quot;&quot;); ;\n                mac = _parameter.tMac;\n            }\n        }\n\n        WlanClient client = new WlanClient();\n\n        foreach (WlanClient.WlanInterface wlanIface in client.Interfaces)\n        {\n            try\n            {\n                string profileXml = string.Format(&quot;&lt;?xml version=\\&quot;1.0\\&quot;?&gt;&lt;WLANProfile xmlns=\\&quot;http://www.microsoft.com/networking/WLAN/profile/v1\\&quot;&gt;&lt;name&gt;{0}&lt;/name&gt;&lt;SSIDConfig&gt;&lt;SSID&gt;&lt;hex&gt;{1}&lt;/hex&gt;&lt;name&gt;{0}&lt;/name&gt;&lt;/SSID&gt;&lt;/SSIDConfig&gt;&lt;connectionType&gt;ESS&lt;/connectionType&gt;&lt;MSM&gt;&lt;security&gt;&lt;authEncryption&gt;&lt;authentication&gt;open&lt;/authentication&gt;&lt;encryption&gt;WEP&lt;/encryption&gt;&lt;useOneX&gt;false&lt;/useOneX&gt;&lt;/authEncryption&gt;&lt;sharedKey&gt;&lt;keyType&gt;networkKey&lt;/keyType&gt;&lt;protected&gt;false&lt;/protected&gt;&lt;keyMaterial&gt;{2}&lt;/keyMaterial&gt;&lt;/sharedKey&gt;&lt;keyIndex&gt;0&lt;/keyIndex&gt;&lt;/security&gt;&lt;/MSM&gt;&lt;/WLANProfile&gt;&quot;, profileName, mac, key);\n                wlanIface.SetProfile(Wlan.WlanProfileFlags.AllUser, profileXml, true);\n                wlanIface.Connect(Wlan.WlanConnectionMode.Profile, Wlan.Dot11BssType.Any, profileName);\n            }\n            catch (Exception ex)\n            {\n                MessageBox.Show(ex.Message);\n            }\n        }\n    }\n}</code></pre>\n\n}<br />\n",
    "PostedDate": "2015-10-20T03:17:03.313-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]