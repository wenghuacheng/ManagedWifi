[
  {
    "Id": "114243",
    "ThreadId": "34405",
    "Html": "First... Great API!!!!&nbsp; <br>\r\n<br>\r\nI cannot find the WlanDisconnect() function.&nbsp; Was this left out or&nbsp;am&nbsp;I overlooking it??&nbsp; Please point me in the direction of the disconnect function and a simple example of how to call it from C#.<br>\r\n<br>\r\nThanks for your help....<br>\r\nWayne\r\n",
    "PostedDate": "2008-08-27T13:39:55.903-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "160129",
    "ThreadId": "34405",
    "Html": "Did you find a way to disconnect? I'm looking for disconnecting also. <br>\r\nthanks for your help.<br>\r\n<br>\r\ncarole<br>\r\n<br>\r\n<br>\r\n",
    "PostedDate": "2009-02-20T05:51:34.607-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "160346",
    "ThreadId": "34405",
    "Html": "The event handler in WlanClient.WlanInterface.WlanConnectionNotification<br>\r\n<br>\r\nIt will alert you of a disconnect.<br>\r\n<br>\r\nExample code: <br>\r\nThis is in my static void main (for a console app)<br>\r\nWlanClient client = new WlanClient();<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (WlanClient.WlanInterface wlanIface in client.Interfaces)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Add the event to track when the wireless connection changes<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wlanIface.WlanConnectionNotification += new WlanClient.WlanInterface.WlanConnectionNotificationEventHandler(wlanIface_WlanConnectionNotification);<br>\r\n}<br>\r\nThis is my event.&nbsp; It will currently write to the console the notification code, one of which is Disconnect.<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static void wlanIface_WlanConnectionNotification(Wlan.WlanNotificationData notifyData, Wlan.WlanConnectionNotificationData connNotifyData)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine(notifyData.NotificationCode);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Console.WriteLine(&quot;{0} to {1} with quality level {2}&quot;,connNotifyData.wlanConnectionMode, connNotifyData.profileName, &quot;-&quot;);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n<br>\r\nHope that helps.<br>\r\n<br>\r\n<strong>After reading the question again - i realized you wanted to actually disconnect from the network... Sorry I didn't answer that question. I'll keep looking around though.</strong><br>\r\n",
    "PostedDate": "2009-02-20T18:12:54.77-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "160863",
    "ThreadId": "34405",
    "Html": "yes, thanks a lot!<br>\r\n<br>\r\ncarole<br>\r\n<br>\r\n",
    "PostedDate": "2009-02-23T01:06:42.84-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "183183",
    "ThreadId": "34405",
    "Html": "<p><span style=\"font-family:'calibri','sans-serif';color:#1f497d;font-size:11pt\">On Interop.cs you should add :</span></p>\r\n<p><span style=\"font-family:'courier new';font-size:10pt\">        [<span style=\"color:#2b91af\">DllImport</span>(<span style=\"color:#a31515\">&quot;wlanapi.dll&quot;</span>)]<br>\r\n</span><span style=\"font-family:'courier new';font-size:10pt\">        <span style=\"color:blue\">public</span> <span style=\"color:blue\">static</span> <span style=\"color:blue\">extern</span> <span style=\"color:blue\">int</span> WlanDisconnect(<br>\r\n</span><span style=\"font-family:'courier new';font-size:10pt\">            [<span style=\"color:#2b91af\">In</span>] <span style=\"color:#2b91af\">IntPtr</span> clientHandle,<br>\r\n</span><span style=\"font-family:'courier new';font-size:10pt\">            [<span style=\"color:#2b91af\">In</span>, <span style=\"color:#2b91af\">MarshalAs</span>(<span style=\"color:#2b91af\">UnmanagedType</span>.LPStruct)] <span style=\"color:#2b91af\">Guid</span> interfaceGuid,<br>\r\n</span><span style=\"font-family:'courier new';font-size:10pt\">            </span><span style=\"font-family:'courier new';color:#2b91af;font-size:10pt\">IntPtr</span><span style=\"font-family:'courier new';font-size:10pt\"> pReserved);</span> </p>\r\n<p><span style=\"font-family:'calibri','sans-serif';color:#1f497d;font-size:11pt\">And on WlanApi:</span></p>\r\n<p><span style=\"font-family:'courier new';font-size:10pt\">            <span style=\"color:gray\">///</span> <span style=\"color:gray\">&lt;summary&gt;<br>\r\n</span><span style=\"font-family:'courier new';font-size:10pt\">            <span style=\"color:gray\">///</span><span style=\"color:green\"> Disconnects to a network<br>\r\n</span><span style=\"font-family:'courier new';font-size:10pt\">            <span style=\"color:gray\">///</span> <span style=\"color:gray\">&lt;/summary&gt;<br>\r\n</span><span style=\"font-family:'courier new';font-size:10pt\">            <span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> Disconnect()<br>\r\n</span><span style=\"font-family:'courier new';font-size:10pt\">            {</span>\r\n<p><span style=\"font-family:'courier new';font-size:10pt\">                <span style=\"color:#2b91af\">Wlan</span>.ThrowIfError(<br>\r\n</span><span style=\"font-family:'courier new';font-size:10pt\">                    <span style=\"color:#2b91af\">Wlan</span>.WlanDisconnect(client.clientHandle, info.interfaceGuid, <span style=\"color:#2b91af\">IntPtr</span>.Zero));<br>\r\n</span><span style=\"font-family:'courier new';font-size:10pt\">            </span><span style=\"font-family:'courier new';font-size:10pt\">}</span> <br>\r\n<br>\r\nWith these you'll be able to call the Disconnect method!! ;)</p>\r\n</span></span></span></p>\r\n",
    "PostedDate": "2009-04-24T03:28:07.4-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "183904",
    "ThreadId": "34405",
    "Html": "\r\n\r\n<div class=Section1>\r\n\r\n<p class=MsoNormal><span style=\"font-size:11.0pt;font-family:'Calibri','sans-serif'\">Thank\r\nyou</span></p>\r\n\r\n<p class=MsoNormal><span style=\"font-size:11.0pt;font-family:'Calibri','sans-serif'\"> </span></p>\r\n\r\n<div>\r\n\r\n<p class=MsoNormal><b><i><span style=\"font-size:14.0pt\">Wayne C. Kessler</span></i></b></p>\r\n\r\n<p class=MsoNormal><span style=\"font-size:11.0pt;font-family:'Calibri','sans-serif'\"><a href=\"mailto:w.kessler3@verizon.net\"><span style=\"font-family:'Times New Roman','serif';color:blue\">w.kessler3@verizon.net</span></a></span><span style=\"font-size:11.0pt\"></span></p>\r\n\r\n<p class=MsoNormal><span style=\"font-size:11.0pt\">cell: (941) 807-6208</span></p>\r\n\r\n</div>\r\n\r\n<p class=MsoNormal><span style=\"font-size:11.0pt;font-family:'Calibri','sans-serif'\"> </span></p>\r\n\r\n<div>\r\n\r\n<div style=\"border:none;border-top:solid #B5C4DF 1.0pt;padding:3.0pt 0in 0in 0in\">\r\n\r\n<p class=MsoNormal><b><span style=\"font-size:10.0pt;font-family:'Tahoma','sans-serif'\">From:</span></b><span style=\"font-size:10.0pt;font-family:'Tahoma','sans-serif'\"> jaumec\r\n[mailto:notifications@codeplex.com] <br>\r\n<b>Sent:</b> Friday, April 24, 2009 6:28 AM<br>\r\n<b>To:</b> w.kessler3@verizon.net<br>\r\n<b>Subject:</b> Re: Disconnect?? [managedwifi:34405]</span></p>\r\n\r\n</div>\r\n\r\n</div>\r\n\r\n<p class=MsoNormal> </p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif'\">From:\r\njaumec</span></p>\r\n\r\n<div style=\"margin-bottom:24.0pt\" id=ThreadNotificationPostBody>\r\n\r\n<p><span style=\"font-size:11.0pt;font-family:'Calibri','sans-serif';color:#1F497D\">On\r\nInterop.cs you should add :</span><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif'\"></span></p>\r\n\r\n<p><span style=\"font-size:10.0pt;font-family:'Courier New'\">       \r\n[<span style=\"color:#2B91AF\">DllImport</span>(<span style=\"color:#A31515\">&quot;wlanapi.dll&quot;</span>)]<br>\r\n        <span style=\"color:blue\">public</span>\r\n<span style=\"color:blue\">static</span> <span style=\"color:blue\">extern</span> <span style=\"color:blue\">int</span> WlanDisconnect(<br>\r\n            [<span style=\"color:#2B91AF\">In</span>] <span style=\"color:#2B91AF\">IntPtr</span>\r\nclientHandle,<br>\r\n            [<span style=\"color:#2B91AF\">In</span>, <span style=\"color:#2B91AF\">MarshalAs</span>(<span style=\"color:#2B91AF\">UnmanagedType</span>.LPStruct)] <span style=\"color:#2B91AF\">Guid</span>\r\ninterfaceGuid,<br>\r\n            <span style=\"color:#2B91AF\">IntPtr</span> pReserved);</span><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif'\"> </span></p>\r\n\r\n<p><span style=\"font-size:11.0pt;font-family:'Calibri','sans-serif';color:#1F497D\">And\r\non WlanApi:</span><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif'\"></span></p>\r\n\r\n<p><span style=\"font-size:10.0pt;font-family:'Courier New'\">           \r\n<span style=\"color:gray\">///</span> <span style=\"color:gray\">&lt;summary&gt;<br>\r\n</span>            <span style=\"color:gray\">///</span><span style=\"color:green\"> Disconnects to a\r\nnetwork<br>\r\n</span>            <span style=\"color:gray\">///</span> <span style=\"color:gray\">&lt;/summary&gt;<br>\r\n</span>            <span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span>\r\nDisconnect()<br>\r\n            { </span></p>\r\n\r\n<p><span style=\"font-size:10.0pt;font-family:'Courier New'\">               \r\n<span style=\"color:#2B91AF\">Wlan</span>.ThrowIfError(<br>\r\n                   \r\n<span style=\"color:#2B91AF\">Wlan</span>.WlanDisconnect(client.clientHandle,\r\ninfo.interfaceGuid, <span style=\"color:#2B91AF\">IntPtr</span>.Zero));<br>\r\n            } <br>\r\n<br>\r\nWith these you'll be able to call the Disconnect method!! ;)</span></p>\r\n\r\n</div>\r\n\r\n<div style=\"border:none;border-top:solid #CCCCCC 1.0pt;padding:0in 0in 0in 0in\" id=ThreadNotificationFooter>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">Read\r\nthe <a href=\"http://managedwifi.codeplex.com/Thread/View.aspx?ThreadId=34405&ANCHOR#Post183183\">full\r\ndiscussion online</a>.</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">To\r\nadd a post to this discussion, reply to this email (<a href=\"mailto:managedwifi@discussions.codeplex.com?subject=[managedwifi:34405]\">managedwifi@discussions.codeplex.com</a>)</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">To\r\nstart a new discussion for this project, email <a href=\"mailto:managedwifi@discussions.codeplex.com\">managedwifi@discussions.codeplex.com</a></span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">You\r\nare receiving this email because you subscribed to this discussion on CodePlex.\r\nYou can <a href=\"http://www.codeplex.com/site/discussions/thread/unsubscribe/34405\">unsubscribe</a>\r\non codePlex.com.</span></p>\r\n\r\n<p><span style=\"font-size:9.0pt;font-family:'Verdana','sans-serif';color:gray\">Please\r\nnote: Images and attachments will be removed from emails. Any posts to this\r\ndiscussion will also be available online at codeplex.com</span></p>\r\n\r\n</div>\r\n\r\n</div>\r\n\r\n",
    "PostedDate": "2009-04-26T20:19:03.117-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "185780",
    "ThreadId": "34405",
    "Html": "Hi guy can any one help in reading or connceting available network and reading all the systems in that network ......<br>\r\nas you guys are discussing about disconnecting wireless network ,hope you guys know how to connect to the available network.. plz help me out...<br>\r\nif i use the connect method i am getting this error &quot;The network connection profile is corrupted&quot;<br>\r\ni am using this code to connect is this right..... and the mac and key is required to connect give me some idea ...<br>\r\n&nbsp;string profileName = SelectedItem.Text;<br>\r\n&nbsp;string mac = &quot;52544131303235572D454137443638&quot;;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string key = &quot;hello&quot;;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string profileXml = string.Format(&quot;&lt;?xml version=\\&quot;2.0\\&quot;?&gt;&lt;WLANProfile xmlns=\\&quot;http://www.microsoft.com/networking/WLAN/profile/v1\\&quot;&gt;&lt;name&gt;{0}&lt;/name&gt;&lt;SSIDConfig&gt;&lt;SSID&gt;&lt;hex&gt;{1}&lt;/hex&gt;&lt;name&gt;{0}&lt;/name&gt;&lt;/SSID&gt;&lt;/SSIDConfig&gt;&lt;connectionType&gt;ESS&lt;/connectionType&gt;&lt;MSM&gt;&lt;security&gt;&lt;authEncryption&gt;&lt;authentication&gt;open&lt;/authentication&gt;&lt;encryption&gt;WEP&lt;/encryption&gt;&lt;useOneX&gt;false&lt;/useOneX&gt;&lt;/authEncryption&gt;&lt;sharedKey&gt;&lt;keyType&gt;networkKey&lt;/keyType&gt;&lt;protected&gt;false&lt;/protected&gt;&lt;keyMaterial&gt;{2}&lt;/keyMaterial&gt;&lt;/sharedKey&gt;&lt;keyIndex&gt;0&lt;/keyIndex&gt;&lt;/security&gt;&lt;/MSM&gt;&lt;/WLANProfile&gt;&quot;, profileName, mac, key);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wlanIface.SetProfile(Wlan.WlanProfileFlags.AllUser, profileXml, true);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wlanIface.Connect(Wlan.WlanConnectionMode.Profile, Wlan.Dot11BssType.Infrastructure, profileName);<br>\r\n<br>\r\nthank you<br>\r\n",
    "PostedDate": "2009-04-30T22:15:50.65-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]