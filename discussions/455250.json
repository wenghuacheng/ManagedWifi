[
  {
    "Id": "1087613",
    "ThreadId": "455250",
    "Html": "Hi every one,<br />\n <br />\nI'm working with ManagedWiFi library. My hope is connecting to special network by SSID. All of step to connecting are in code. I found many sample and create a tiny code that:<br />\n<pre><code>           WlanClient.WlanInterface tempIFace = null;\n            WlanClient client = new WlanClient();\n\n            foreach ( WlanClient.WlanInterface wlanIface in client.Interfaces )\n            {\n                // Lists all available networks\n                Wlan.WlanAvailableNetwork[] networks = wlanIface.GetAvailableNetworkList( 0 );\n                foreach ( Wlan.WlanAvailableNetwork network in networks )\n                {\n                    if ( GetStringForSSID( network.dot11Ssid ).Equals( &quot;test&quot; ) )\n                    {\n                        string profileName = GetStringForSSID( network.dot11Ssid );\n                        var macAddress = ConvertToHex( GetStringForSSID( network.dot11Ssid ) );\n                        string mac = macAddress;\n                        string key = &quot;123456789a&quot;;\n                        string profileXml = string.Format( &quot;&lt;?xml version=\\&quot;1.0\\&quot;?&gt;&lt;WLANProfile xmlns=\\&quot;http://www.microsoft.com/networking/WLAN/profile/v1\\&quot;&gt;&lt;name&gt;{0}&lt;/name&gt;&lt;SSIDConfig&gt;&lt;SSID&gt;&lt;hex&gt;{1}&lt;/hex&gt;&lt;/SSID&gt;&lt;/SSIDConfig&gt;&lt;connectionType&gt;ESS&lt;/connectionType&gt;&lt;MSM&gt;&lt;security&gt;&lt;authEncryption&gt;&lt;authentication&gt;open&lt;/authentication&gt;&lt;encryption&gt;WEP&lt;/encryption&gt;&lt;useOneX&gt;false&lt;/useOneX&gt;&lt;/authEncryption&gt;&lt;sharedKey&gt;&lt;keyType&gt;networkKey&lt;/keyType&gt;&lt;protected&gt;false&lt;/protected&gt;&lt;keyMaterial&gt;{2}&lt;/keyMaterial&gt;&lt;/sharedKey&gt;&lt;keyIndex&gt;0&lt;/keyIndex&gt;&lt;/security&gt;&lt;/MSM&gt;&lt;/WLANProfile&gt;&quot;, profileName, mac, key );\n                        tempIFace = wlanIface;\n                        tempIFace.SetProfile( Wlan.WlanProfileFlags.AllUser, profileXml, true );\n                        tempIFace.Connect( Wlan.WlanConnectionMode.Profile, Wlan.Dot11BssType.Any, GetStringForSSID( network.dot11Ssid ) );\n                        MessageBox.Show( GetStringForSSID( network.dot11Ssid ) );\n                        break;\n          } </code></pre>\n\n<pre><code>static string GetStringForSSID( Wlan.Dot11Ssid ssid )\n        {\n            return Encoding.ASCII.GetString( ssid.SSID, 0, (int)ssid.SSIDLength );\n        }\n\n        public string ConvertToHex( string asciiString )\n        {\n            string hex = &quot;&quot;;\n            foreach ( char c in asciiString )\n            {\n                int tmp = c;\n                hex += String.Format( &quot;{0:x2}&quot;, (uint)System.Convert.ToUInt32( tmp.ToString() ) );\n            }\n            return hex;\n        }\n</code></pre>\n\nthis code run very fine. but cannot connect to this wifi.<br />\n <br />\nPlease tell me what is problem? and how to fix it.<br />\n<br />\nP/S: Can ManagedWiFi connect success to ad-hoc network? if can, please tell me it look like abow code? how to do it? <br />\nThanks.<br />\n",
    "PostedDate": "2013-09-03T03:53:39.19-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]